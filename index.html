import React, { useState, useEffect, useRef } from 'react';
import {
  User, Briefcase, GraduationCap, Award, Mail, Phone, MapPin, Linkedin,
  BarChart, Database, Cog, ClipboardList, Palette, Search, GitBranch,
  FileText, Zap, Lightbulb, Settings, Book, Home,
} from 'lucide-react';

// Main App Component
const App = () => {
  // State to manage section visibility for animation and active navigation tab
  const [activeSection, setActiveSection] = useState(null);
  // State to control the visibility of the mini-profile
  const [showMiniProfile, setShowMiniProfile] = useState(false);

  // Ref for the header section to determine scroll threshold
  const headerRef = useRef(null);

  // Data for the portfolio, extracted from the resume
  const portfolioData = {
    name: "ARAVIND AGORAMURTHI",
    title: "Business Operations Specialist",
    summary: "Business Operations Specialist with 2+ years of experience in driving efficient sales and business operations. Specializes in supporting core sales and revenue operations processes, ensuring seamless execution, strategic alignment, and process consistency across teams. Focuses on CRM optimization and operational visibility, streamlining workflows, and enhancing team productivity. Brings a deep understanding of revenue workflows, sales enablement, and cross-functional collaboration. Known for enabling data-driven decisions and continuous improvement, with a focus on building scalable, insight-led, and performance-oriented operations.",
    image: "https://raw.githubusercontent.com/aravindrakro/my-bizops-portfolio/main/aravind-profile.jpg",
    contact: {
      phone: "+919944864090",
      email: "a.aravindkkl@gmail.com",
      location: "Chennai",
      linkedin: "https://www.linkedin.com/in/aravind-agoramurthi/",
    },
    skills: {
      "CRM & Sales Operations": [
        "HubSpot CRM (Sequences, Workflow Automation)", "Microsoft Dynamics 365", "Salesforce (Pursuing)",
        "DevRev", "SendGrid", "Outplay"
      ],
      "Data Analytics & Reporting": [
        "Power BI", "Excel (Pivot Tables, Macros)", "Looker Studio", "BigQuery", "SQL (Basics)"
      ],
      "Sales Intelligence & Research": [
        "6sense", "ZoomInfo", "LinkedIn Sales Navigator", "Infotelligent", "Apollo", "Kendo"
      ],
      "Project Management & Process Improvement": [
        "Microsoft Project", "DevRev", "Airtable", "Microsoft Visio"
      ],
      "Design & Communication": [
        "PowerPoint", "Figma", "Canva", "Photoshop"
      ],
    },
    experience: [
      {
        title: "Business Operations - Executive",
        company: "Korcomptenz Inc",
        duration: "Jan 2025 - Present",
        details: [
          "Streamlined business processes by optimizing workflows in HubSpot and Microsoft Dynamics 365, reducing data entry errors by 25% and enhancing lead management efficiency.",
          "Led training sessions for over 10 team members on HubSpot CRM, boosting CRM adoption by 30% and ensuring uniform usage across different departments.",
          "Developed over 15 Power BI dashboards, cutting down reporting time by 40% and empowering leadership with timely, actionable insights.",
          "Designed and implemented comprehensive SOPs for sales, marketing, and lead generation activities, ensuring consistency, scalability, and operational smoothness.",
          "Utilized ZoomInfo to pinpoint 500+ high-potential clients, driving a 20% increase in lead conversion and optimizing the sales pipeline.",
          "Conducted thorough industry research to refine sales strategies, identify emerging trends, and unlock new business development opportunities.",
          "Crafted persuasive proposals and visually appealing presentations with PowerPoint, Canva and Figma, enhancing client engagement and business proposals.",
          "Leveraged Apollo and LinkedIn Sales Navigator to improve marketing outreach, streamline lead nurturing processes, and enhance overall operational efficiency.",
        ],
      },
      {
        title: "Sales Operations Trainee",
        company: "Korcomptenz Inc",
        duration: "Aug 2023 - Dec 2024",
        details: [
          "Spearheaded the optimization and maintenance of CRM systems (HubSpot and Microsoft Dynamics 365), ensuring seamless integration, accurate data tracking, and improved lead conversion rates.",
          "Streamlined sales processes by automating workflows within HubSpot, reducing manual tasks and enhancing lead tracking efficiency.",
          "Developed custom reports and dashboards using Power BI, enabling leadership to make data-driven decisions and improving the overall visibility of sales performance metrics.",
          "Worked closely with the sales, marketing, and finance teams to align sales strategies with business objectives, improving communication, coordination, and operational efficiency.",
          "Managed the sales pipeline and forecasting process, ensuring accurate tracking of leads and opportunities and contributing to strategic decision-making for sales targets.",
          "Provided ongoing training and support to the sales team on CRM usage, sales processes, and tools, driving greater adoption and improving overall sales performance across the team.",
        ],
      },
      {
        title: "Strategic Operations - Intern",
        company: "DevRev",
        duration: "Jun 2022 - Feb 2023",
        details: [
          "Analyzed 10,000+ data points using Looker Studio & Excel, generating insights that improved business strategy alignment by 20%.",
          "Managed CRM workflows, reducing lead processing time by 30% and improving customer engagement tracking.",
          "Proficient in managing multiple tools effectively, handling administrative tasks, and maintaining comprehensive documentation.",
          "SEO techniques and data reporting for website performance and decision-making.",
          "Thrives in multicultural environments and excels in collaborating effectively with diverse teams.",
          "Proficient in creating Pivot tables for data analysis and visualization.",
        ],
      },
    ],
    education: [
      {
        degree: "MBA (Business Analytics and Operations)",
        cgpa: "9.01",
        year: "2021-2023",
        institution: "SRM Institute of Science and Technology, Chennai.",
      },
      {
        degree: "B.E. (Mechanical Engineering)",
        cgpa: "7.0",
        year: "2016-2020",
        institution: "Panimalar Engineering College, Chennai.",
      },
    ],
    certifications: {
      "CRM & Sales Operations": [
        "HubSpot Sales Software Certification", "Salesforce CRM (Pursuing)"
      ],
      "Data and Analytics": [
        "Analyzing & Visualizing Data in Looker Google", "IBM Data Fundamentals"
      ],
      "Automation": [
        "Zapier Automation Fundamentals", "HubSpot Workflow Automation"
      ],
      "Generative AI": [
        "Google Generative AI (LLM) & Basics of Prompt Design Google"
      ],
      "Database": [
        "MySQL Basics - Oracle"
      ],
      "Project Management and Agile": [
        "Agile Foundations Project Management Institute (PMI)", "Project Management Foundations - PMI", "Microsoft Projects Certification - PIM"
      ],
    },
  };

  // Function to determine the icon for each skill category
  const getSkillIcon = (category) => {
    switch (category) {
      case "CRM & Sales Operations": return <Cog className="text-blue-500" />;
      case "Data Analytics & Reporting": return <BarChart className="text-green-500" />;
      case "Sales Intelligence & Research": return <Search className="text-purple-500" />;
      case "Project Management & Process Improvement": return <ClipboardList className="text-yellow-500" />;
      case "Design & Communication": return <Palette className="text-red-500" />;
      default: return <Settings className="text-gray-500" />;
    }
  };

  // Function to determine the icon for each certification category
  const getCertificationIcon = (category) => {
    switch (category) {
      case "CRM & Sales Operations": return <Briefcase className="text-blue-500" />;
      case "Data and Analytics": return <Database className="text-green-500" />;
      case "Automation": return <Zap className="text-orange-500" />;
      case "Generative AI": return <Lightbulb className="text-indigo-500" />;
      case "Database": return <Book className="text-gray-500" />;
      case "Project Management and Agile": return <GitBranch className="text-purple-500" />;
      default: return <Award className="text-gray-500" />;
    }
  };

  // Function to smoothly scroll to a section
  const scrollToSection = (id) => {
    const element = document.getElementById(id);
    if (element) {
      // Offset for fixed header
      const offset = document.querySelector('nav').offsetHeight;
      const bodyRect = document.body.getBoundingClientRect().top;
      const elementRect = element.getBoundingClientRect().top;
      const elementPosition = elementRect - bodyRect;
      const offsetPosition = elementPosition - offset;

      window.scrollTo({
        top: offsetPosition,
        behavior: 'smooth'
      });
    }
  };

  // Effect to handle scroll-based animations and update active section for navigation
  useEffect(() => {
    const handleScroll = () => {
      const sections = document.querySelectorAll('section[id]');
      let currentActive = null;

      sections.forEach(section => {
        const sectionTop = section.getBoundingClientRect().top;
        const sectionBottom = section.getBoundingClientRect().bottom;
        // Adjust threshold based on navigation bar height
        const navHeight = document.querySelector('nav')?.offsetHeight || 0;
        if (sectionTop <= navHeight + window.innerHeight / 3 && sectionBottom >= navHeight + window.innerHeight / 3) {
          currentActive = section.id;
        }
      });
      setActiveSection(currentActive);

      // Logic for showing/hiding mini-profile
      if (headerRef.current) {
        const headerBottom = headerRef.current.getBoundingClientRect().bottom;
        setShowMiniProfile(headerBottom < 0); // Show if header is scrolled out of view
      }
    };

    window.addEventListener('scroll', handleScroll);
    handleScroll(); // Initial check

    return () => window.removeEventListener('scroll', handleScroll);
  }, []);

  // Helper component for section headers with icons and animations
  const SectionHeader = ({ id, icon: Icon, title }) => (
    <h2
      id={id}
      className={`text-3xl md:text-4xl font-extrabold text-gray-800 mb-8 flex items-center justify-center space-x-4 transition-all duration-700 ease-out transform
        ${activeSection === id ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-10'}`}
    >
      <Icon size={40} className="text-indigo-600" />
      <span>{title}</span>
    </h2>
  );

  return (
    <div className="min-h-screen bg-gradient-to-br from-indigo-50 to-purple-100 font-inter text-gray-900 leading-relaxed pt-20 md:pt-24">
      {/* Tailwind CSS CDN - included in the head of the HTML */}
      <script src="https://cdn.tailwindcss.com"></script>
      <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet" />

      {/* Fixed Navigation Bar */}
      <nav className="fixed top-0 left-0 right-0 bg-white/90 backdrop-blur-sm shadow-lg py-4 z-50 rounded-b-xl">
        <div className="container mx-auto px-6 flex flex-wrap justify-center gap-2 md:gap-4">
          {/* Mini-Profile in Nav Bar */}
          <div
            className={`absolute top-1/2 -translate-y-1/2 left-4 flex items-center gap-2 transition-all duration-500 ${
              showMiniProfile ? 'opacity-100 translate-x-0' : 'opacity-0 -translate-x-full'
            }`}
          >
            <img
              src={portfolioData.image}
              alt={portfolioData.name}
              className="w-10 h-10 rounded-full object-cover border-2 border-indigo-600"
              onError={(e) => {
                e.target.onerror = null;
                e.target.src = "https://placehold.co/40x40/E0E7FF/6366F1?text=P";
              }}
            />
            <span className="font-bold text-indigo-800 text-sm md:text-base">
              {portfolioData.name.split(' ')[0]}
            </span>
          </div>

          {[
            { id: 'summary', label: 'About Me', icon: User },
            { id: 'skills', label: 'Skills', icon: Settings },
            { id: 'experience', label: 'Experience', icon: Briefcase },
            { id: 'education', label: 'Education', icon: GraduationCap },
            { id: 'certifications', label: 'Certifications', icon: Award },
          ].map((item) => (
            <div
              key={item.id}
              onClick={() => scrollToSection(item.id)}
              className={`group flex items-center cursor-pointer p-2 rounded-lg transition-all duration-300 relative overflow-hidden
                ${activeSection === item.id ? 'text-indigo-700 bg-indigo-50 shadow-md scale-105' : 'text-gray-600 hover:text-indigo-700 hover:bg-gray-50 hover:scale-105'}`}
            >
              <item.icon size={24} className="flex-shrink-0 transition-all duration-300 group-hover:scale-110" />
              <span className="ml-2 whitespace-nowrap overflow-hidden max-w-0 group-hover:max-w-xs group-hover:w-auto opacity-0 group-hover:opacity-100 transition-all duration-300 ease-out text-sm font-medium">
                {item.label}
              </span>
            </div>
          ))}
        </div>
      </nav>

      {/* Header Section */}
      <header ref={headerRef} className="relative bg-gradient-to-r from-indigo-700 to-purple-800 text-white py-16 md:py-24 shadow-xl overflow-hidden rounded-b-3xl">
        <div className="container mx-auto px-6 flex flex-col md:flex-row items-center justify-between relative z-10">
          <div className="flex flex-col items-center md:items-start text-center md:text-left mb-8 md:mb-0">
            <h1 className="text-4xl md:text-6xl font-extrabold mb-2 animate-fade-in-down">
              {portfolioData.name}
            </h1>
            <p className="text-xl md:text-2xl font-light mb-6 animate-fade-in-up">
              {portfolioData.title}
            </p>
            <div className="flex flex-wrap justify-center md:justify-start gap-4 text-lg">
              <span className="flex items-center gap-2 animate-fade-in-left">
                <Mail size={20} /> {portfolioData.contact.email}
              </span>
              <span className="flex items-center gap-2 animate-fade-in-left delay-100">
                <Phone size={20} /> {portfolioData.contact.phone}
              </span>
              <span className="flex items-center gap-2 animate-fade-in-left delay-200">
                <MapPin size={20} /> {portfolioData.contact.location}
              </span>
              <a
                href={portfolioData.contact.linkedin}
                target="_blank"
                rel="noopener noreferrer"
                className="flex items-center gap-2 text-white hover:text-blue-300 transition duration-300 animate-fade-in-left delay-300"
              >
                <Linkedin size={20} /> LinkedIn
              </a>
            </div>
          </div>
          <div className="relative w-48 h-48 md:w-64 md:h-64 rounded-full overflow-hidden shadow-2xl border-4 border-white transform hover:scale-105 transition-transform duration-500 animate-fade-in-right">
            <img
              src={portfolioData.image}
              alt={portfolioData.name}
              className="object-cover w-full h-full"
              onError={(e) => {
                e.target.onerror = null; // prevents looping
                e.target.src = "https://placehold.co/256x256/E0E7FF/6366F1?text=Profile"; // Placeholder image
              }}
            />
          </div>
        </div>
        {/* Background animation elements */}
        <div className="absolute top-0 left-0 w-full h-full">
          <div className="absolute w-40 h-40 bg-white opacity-10 rounded-full -top-10 -left-10 animate-pulse-slow"></div>
          <div className="absolute w-60 h-60 bg-white opacity-10 rounded-full -bottom-20 -right-20 animate-pulse-slow delay-200"></div>
        </div>
      </header>

      <main className="container mx-auto px-6 py-16">
        {/* Summary Section */}
        <section id="summary" className={`mb-16 p-8 bg-white/80 rounded-2xl shadow-lg transition-all duration-700 ease-out transform ${activeSection === 'summary' ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-10'}`}>
          <SectionHeader id="summary" icon={User} title="About Me" />
          <p className="text-lg md:text-xl text-gray-700 leading-relaxed text-center max-w-3xl mx-auto">
            {portfolioData.summary}
          </p>
        </section>

        {/* Technical Skills Section */}
        <section id="skills" className={`mb-16 p-8 bg-white/80 rounded-2xl shadow-lg transition-all duration-700 ease-out transform ${activeSection === 'skills' ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-10'}`}>
          <SectionHeader id="skills" icon={Settings} title="Technical Skills" />
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            {Object.entries(portfolioData.skills).map(([category, items], index) => (
              <div
                key={category}
                className="bg-white/70 p-6 rounded-xl shadow-md border border-gray-200 hover:shadow-xl transform hover:-translate-y-1 transition duration-300 ease-in-out"
                style={{ animationDelay: `${index * 0.1}s` }}
              >
                <h3 className="text-xl font-semibold text-gray-800 mb-4 flex items-center gap-3">
                  {getSkillIcon(category)}
                  {category}
                </h3>
                <ul className="list-disc list-inside text-gray-700 space-y-2">
                  {items.map((item, i) => (
                    <li key={i} className="flex items-start">
                      <span className="text-indigo-500 mr-2">•</span>
                      <span>{item}</span>
                    </li>
                  ))}
                </ul>
              </div>
            ))}
          </div>
        </section>

        {/* Experience Section */}
        <section id="experience" className={`mb-16 p-8 bg-white/80 rounded-2xl shadow-lg transition-all duration-700 ease-out transform ${activeSection === 'experience' ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-10'}`}>
          <SectionHeader id="experience" icon={Briefcase} title="Experience" />
          <div className="relative border-l-4 border-indigo-300 ml-4 md:ml-12">
            {portfolioData.experience.map((job, index) => (
              <div
                key={index}
                className="mb-10 ml-8 md:ml-10 p-6 bg-white/70 rounded-xl shadow-md border border-gray-200 relative
                  before:content-[''] before:absolute before:left-[-2.5rem] before:top-4 before:w-6 before:h-6 before:bg-indigo-600 before:rounded-full before:border-4 before:border-white
                  transform hover:scale-[1.01] transition duration-300 ease-in-out"
                style={{ animationDelay: `${index * 0.15}s` }}
              >
                <h3 className="text-2xl font-bold text-gray-800 mb-1">{job.title}</h3>
                <p className="text-xl font-semibold text-indigo-600 mb-2">{job.company}</p>
                <p className="text-md text-gray-500 mb-4">{job.duration}</p>
                <ul className="list-disc list-inside text-gray-700 space-y-2">
                  {job.details.map((detail, i) => (
                    <li key={i} className="flex items-start">
                      <span className="text-indigo-500 mr-2">•</span>
                      <span>{detail}</span>
                    </li>
                  ))}
                </ul>
              </div>
            ))}
          </div>
        </section>

        {/* Education Section */}
        <section id="education" className={`mb-16 p-8 bg-white/80 rounded-2xl shadow-lg transition-all duration-700 ease-out transform ${activeSection === 'education' ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-10'}`}>
          <SectionHeader id="education" icon={GraduationCap} title="Education" />
          <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
            {portfolioData.education.map((edu, index) => (
              <div
                key={index}
                className="bg-white/70 p-6 rounded-xl shadow-md border border-gray-200 hover:shadow-xl transform hover:-translate-y-1 transition duration-300 ease-in-out"
                style={{ animationDelay: `${index * 0.1}s` }}
              >
                <h3 className="text-xl font-bold text-gray-800 mb-2">{edu.degree}</h3>
                <p className="text-lg text-indigo-600 mb-1">{edu.institution}</p>
                <p className="text-md text-gray-600 mb-1">CGPA: {edu.cgpa}</p>
                <p className="text-md text-gray-600">{edu.year}</p>
              </div>
            ))}
          </div>
        </section>

        {/* Certifications Section */}
        <section id="certifications" className={`mb-16 p-8 bg-white/80 rounded-2xl shadow-lg transition-all duration-700 ease-out transform ${activeSection === 'certifications' ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-10'}`}>
          <SectionHeader id="certifications" icon={Award} title="Certifications" />
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            {Object.entries(portfolioData.certifications).map(([category, items], index) => (
              <div
                key={category}
                className="bg-white/70 p-6 rounded-xl shadow-md border border-gray-200 hover:shadow-xl transform hover:-translate-y-1 transition duration-300 ease-in-out"
                style={{ animationDelay: `${index * 0.1}s` }}
              >
                <h3 className="text-xl font-semibold text-gray-800 mb-4 flex items-center gap-3">
                  {getCertificationIcon(category)}
                  {category}
                </h3>
                <ul className="list-disc list-inside text-gray-700 space-y-2">
                  {items.map((item, i) => (
                    <li key={i} className="flex items-start">
                      <span className="text-indigo-500 mr-2">•</span>
                      <span>{item}</span>
                    </li>
                  ))}
                </ul>
              </div>
            ))}
          </div>
        </section>
      </main>

      {/* Footer */}
      <footer className="bg-gray-800 text-white py-8 text-center rounded-t-3xl">
        <p className="text-lg">&copy; {new Date().getFullYear()} Aravind Agoramurthi. All rights reserved.</p>
        <div className="flex justify-center mt-4 space-x-4">
          <a
            href={portfolioData.contact.linkedin}
            target="_blank"
            rel="noopener noreferrer"
            className="text-white hover:text-blue-400 transition duration-300"
          >
            <Linkedin size={24} />
          </a>
          <a href={`mailto:${portfolioData.contact.email}`} className="text-white hover:text-red-400 transition duration-300">
            <Mail size={24} />
          </a>
          <a href={`tel:${portfolioData.contact.phone}`} className="text-white hover:text-green-400 transition duration-300">
            <Phone size={24} />
          </a>
        </div>
      </footer>

      {/* Custom CSS for animations and font */}
      <style>{`
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap');

        body {
          font-family: 'Inter', sans-serif;
        }

        /* Fade-in-down animation */
        @keyframes fade-in-down {
          from {
            opacity: 0;
            transform: translateY(-20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
        .animate-fade-in-down {
          animation: fade-in-down 0.8s ease-out forwards;
        }

        /* Fade-in-up animation */
        @keyframes fade-in-up {
          from {
            opacity: 0;
            transform: translateY(20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
        .animate-fade-in-up {
          animation: fade-in-up 0.8s ease-out forwards;
        }

        /* Fade-in-left animation */
        @keyframes fade-in-left {
          from {
            opacity: 0;
            transform: translateX(-20px);
          }
          to {
            opacity: 1;
            transform: translateX(0);
          }
        }
        .animate-fade-in-left {
          animation: fade-in-left 0.8s ease-out forwards;
        }

        /* Fade-in-right animation */
        @keyframes fade-in-right {
          from {
            opacity: 0;
            transform: translateX(20px);
          }
          to {
            opacity: 1;
            transform: translateX(0);
          }
        }
        .animate-fade-in-right {
          animation: fade-in-right 0.8s ease-out forwards;
        }

        /* Pulse slow animation for background elements */
        @keyframes pulse-slow {
          0% {
            transform: scale(1);
            opacity: 0.1;
          }
          50% {
            transform: scale(1.1);
            opacity: 0.2;
          }
          100% {
            transform: scale(1);
            opacity: 0.1;
          }
        }
        .animate-pulse-slow {
          animation: pulse-slow 6s infinite ease-in-out;
        }
      `}</style>
    </div>
  );
};

export default App;
